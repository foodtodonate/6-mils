<?xml version="1.0" encoding="ISO-8859-1" standalone="no" ?>
<!DOCTYPE cXML SYSTEM "http://xml.cxml.org/schemas/cXML/1.2.014/InvoiceDetail.dtd">
<cXML payloadID="{{ payloadId }}" timestamp="{{ timeStamp }}" version="1.2.014" xml:lang="{{ language }}" >
    <Header>
        <From>
            <Credential domain="{{ header.from.domain }}">
                <Identity>{{ header.from.identity }}</Identity>
            </Credential>
        </From>
        <To>
            <Credential domain="{{ header.to.domain }}">
                <Identity>{{ header.to.identity }}</Identity>
            </Credential>
        </To>
        <Sender>
            <Credential domain="{{ header.sender.domain }}">
                <Identity>{{ header.sender.identity }}</Identity>
                <SharedSecret>{{ header.sender.sharedSecret }}</SharedSecret>
            </Credential>
            <UserAgent>{{ header.sender.userAgent }}</UserAgent>
        </Sender>
    </Header>
    <Request deploymentMode="{{ request.deploymentMode }}">
            <InvoiceDetailRequest>
                <InvoiceDetailRequestHeader invoiceDate="{{ request.requestHeader.invoiceDate }}" invoiceID="{{ request.requestHeader.invoiceId }}" operation="{{ request.requestHeader.operation }}" purpose="{{ request.requestHeader.purpose }}" >
                    <InvoiceDetailHeaderIndicator/>
                    <InvoiceDetailLineIndicator isTaxInLine="{{ request.requestHeader.isTaxInLine }}" ></InvoiceDetailLineIndicator>
                       {% for contact in request.invoiceDetailReq.invoicePartner.contact %}
                            <InvoicePartner>
                                    {% if contact.role == "remitTo" or contact.role == "shipTo"%}
                                        <Contact role="{{ contact.role }}" addressID="{{ contact.addressId }}" >
                                    {% else %}
                                        <Contact role="{{ contact.role }}">
                                    {% endif %}
                                            <Name xml:lang="{{ contact.language }}"></Name>
                                            <PostalAddress>
                                                <Street>{{ contact.street }}</Street>
                                                <City>{{ contact.city }}</City>
                                                <State>{{ contact.state }}</State>
                                                <PostalCode>{{ contact.postalCode }}</PostalCode>
                                                <Country isoCountryCode="{{ contact.isoCountryCode }}" >{{ contact.country }}</Country>
                                            </PostalAddress>
                                        </Contact>
                                        {% if contact.role == "remitTo"%}
                                            <IdReference domain="{{ contact.domain }}" identifier="{{ contact.identifier }}"></IdReference>
                                        {% endif %}
                            </InvoicePartner>
                        {% endfor %}
                    <InvoiceDetailShipping>
                        {% for contact in request.invoiceDetailReq.invoiceDetailShip.contact %}
                            {% if contact.role == "shipFrom" %}
                                <Contact role="{{ contact.role }}" >
                            {% else %}
                            <Contact addressID="{{ contact.addressId }}" role="{{ contact.role }}" >
                            {% endif %}
                                    <Name xml:lang="{{ contact.language }}" >{{ contact.name }}</Name>
                                    <PostalAddress>
                                        <Street>{{ contact.street }}</Street>
                                        <City>{{ contact.city }}</City>
                                        <State>{{ contact.state }}</State>
                                        <PostalCode>{{ contact.postalCode }}</PostalCode>
                                        <Country isoCountryCode="{{ contact.isoCountryCode }}" >{{ contact.country }}</Country>
                                    </PostalAddress>
                                </Contact>
                        {% endfor %}
                    </InvoiceDetailShipping>
                    <InvoiceDetailPaymentTerm percentageRate="{{ request.invoiceDetailReq.invoiceDetailPaymentTerm.percentRate }}" payInNumberOfDays="{{ request.invoiceDetailReq.invoiceDetailPaymentTerm.payInNumOfDays }}" ></InvoiceDetailPaymentTerm>
                </InvoiceDetailRequestHeader>
                <InvoiceDetailOrder>
                    <InvoiceDetailOrderInfo>
                        <MasterAgreementReference>
                            <DocumentReference payloadID="{{ request.invoiceDetailReq.invoiceDetailOrder.payloadId }}"/>
                        </MasterAgreementReference>
                    </InvoiceDetailOrderInfo>
                    {% for item in request.invoiceDetailReq.invoiceDetailOrder.item.list %}
                        <InvoiceDetailItem invoiceLineNumber="{{ item.invoiceLineNumber }}" quantity="{{ item.quantity }}" >
                            <UnitOfMeasure>{{ item.UOM }}</UnitOfMeasure>
                            <UnitPrice>
                                <Money currency="{{ item.UnitPtice_currency }}" >{{ item.UnitPrice_money }}</Money>
                            </UnitPrice>
                            <InvoiceDetailItemReference lineNumber="{{ item.invoiceLineNumber }}" >
                                <ItemID>
                                    <SupplierPartID>{{ item.PartId }}</SupplierPartID>
                                </ItemID>
                                <Description xml:lang="{{ item.PartDescription_language }}" >{{ item.PartDescription }} </Description>
                                <ManufacturerPartID/>
                                <ManufacturerName>{{ item.manufacturer_name }}</ManufacturerName>
                            </InvoiceDetailItemReference>
                            <SubtotalAmount>
                                <Money currency="{{ item.sub_total_currency }}" >{{ item.Subtotal }}</Money>
                            </SubtotalAmount>
                                <Tax>
                                    <Money currency="{{ item.tax_currency }}" >{{ item.tax_amt }}</Money>
                                    <Description xml:lang="{{ item.tax_desc_language }}" >{{ item.tax_desc }}</Description>
                                    {% for tax in request.invoiceDetailReq.invoiceDetailOrder.item.tax %}
                                        <TaxDetail category="{{ tax.category }}" percentageRate="{{ tax.percent_rate }}" purpose="{{ tax.purpose }}" >
                                            <TaxableAmount>
                                                <Money currency="{{ tax.taxable_currency }}" >{{ tax.taxable_amt }}</Money>
                                            </TaxableAmount>
                                            <TaxAmount>
                                                <Money currency="{{ tax.taxable_currency }}" >{{ tax.tax_amt }}</Money>
                                            </TaxAmount>
                                            <TaxLocation xml:lang="{{ tax.tax_location_lang }}" >{{ tax.tax_location }}</TaxLocation>
                                            <Description xml:lang="{{ tax.tax_desc_lang }}" >{{ tax.tax_desc }}</Description>
                                        </TaxDetail>
                                    {% endfor %}
                                </Tax>
                            <GrossAmount>
                                <Money currency="{{ item.gross_amt_currency }}" >{{ item.gross_amt }}</Money>
                            </GrossAmount>
                            <NetAmount>
                                <Money currency="{{ item.net_amt_currency }}" >{{ item.net_amt }}</Money>
                            </NetAmount>
                        </InvoiceDetailItem>
                    {% endfor %}
                </InvoiceDetailOrder>
                    <InvoiceDetailSummary>
                        {% for summary in request.invoiceDetailReq.invoiceDetailSummary.summary.total %}
                            <SubtotalAmount>
                                <Money currency="{{ summary.sub_total_currency }}">{{ summary.sub_total_amt }}</Money>
                            </SubtotalAmount>
                            <Tax>
                                <Money currency="{{ summary.sub_total_currency }}" >{{ summary.sub_total_amt }}</Money>
                                <Description xml:lang="{{ summary.tax_desc_lang }}" >{{ summary.tax_desc }}</Description>
                                {% for summaryTax in request.invoiceDetailReq.invoiceDetailSummary.summary.tax %}
                                    <TaxDetail category="{{ summaryTax.category }}" percentageRate="{{ summaryTax.percent_rate }}" purpose="{{ summaryTax.purpose }}">
                                        <TaxableAmount>
                                            <Money currency="{{ summaryTax.taxable_currency }}" >{{ summaryTax.taxable_amt }}</Money>
                                        </TaxableAmount>
                                        <TaxAmount>
                                            <Money currency="{{ summaryTax.taxable_currency }}" >{{ summaryTax.tax_amt}}</Money>
                                        </TaxAmount>
                                        <TaxLocation xml:lang="{{ summaryTax.tax_location_lang }}" >{{ summaryTax.tax_location }}</TaxLocation>
                                        <Description xml:lang="{{ summaryTax.tax_desc_lang }}" >{{ summaryTax.tax_desc }}</Description>
                                    </TaxDetail>
                                {% endfor %}
                            </Tax>
                            <ShippingAmount>
                                <Money currency="{{ summary.shipping_Currency }}" >{{ summary.shipping_amt }}</Money>
                            </ShippingAmount>
                            <GrossAmount>
                                <Money currency="{{ summary.gross_currency }}" >{{ summary.gross_amt }}</Money>
                            </GrossAmount>
                            <NetAmount>
                                <Money currency="{{ summary.net_currency }}" >{{ summary.net_amt }}</Money>
                            </NetAmount>
                            <DueAmount>
                                <Money currency="{{ summary.due_currency }}" >{{ summary.due_amt }}</Money>
                            </DueAmount>
                        {% endfor %}
                    </InvoiceDetailSummary>
            </InvoiceDetailRequest>
    </Request>
</cXML>





